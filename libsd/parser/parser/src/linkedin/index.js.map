{"version":3,"sources":["../../../../../../libs/parser/src/linkedin/index.ts"],"sourcesContent":["import { createId } from \"@paralleldrive/cuid2\";\nimport {\n  defaultCertification,\n  defaultEducation,\n  defaultExperience,\n  defaultLanguage,\n  defaultProfile,\n  defaultProject,\n  defaultResumeData,\n  defaultSkill,\n  ResumeData,\n  resumeDataSchema,\n} from \"@reactive-resume/schema\";\nimport { extractUrl, Json, parseArrayLikeCSVEntry, parseCSV } from \"@reactive-resume/utils\";\nimport * as JSZip from \"jszip\";\nimport { Schema } from \"zod\";\n\nimport { Parser } from \"../interfaces/parser\";\nimport { LinkedIn, linkedInSchema } from \"./schema\";\n\nexport * from \"./schema\";\n\nexport class LinkedInParser implements Parser<JSZip, LinkedIn> {\n  schema: Schema;\n\n  constructor() {\n    this.schema = linkedInSchema;\n  }\n\n  async readFile(file: File): Promise<JSZip> {\n    const data = await JSZip.loadAsync(file);\n\n    if (Object.keys(data.files).length === 0) {\n      throw new Error(\"ParserError: There were no files found inside the zip archive.\");\n    }\n\n    return data;\n  }\n\n  async validate(data: JSZip) {\n    const result: Json = {};\n\n    for (const [name, file] of Object.entries(data.files)) {\n      for (const key of Object.keys(linkedInSchema.shape)) {\n        if (name.includes(key)) {\n          const content = await file.async(\"text\");\n          const jsonArray = await parseCSV(content);\n          result[key] = jsonArray;\n        }\n      }\n    }\n\n    return linkedInSchema.parse(result);\n  }\n\n  convert(data: LinkedIn) {\n    const result = JSON.parse(JSON.stringify(defaultResumeData)) as ResumeData;\n\n    const avoidTooShort = (name: string, len: number) => {\n      if (!name || name.length < len) return \"Unknown\";\n      return name;\n    };\n\n    // Profile\n    if (data.Profile && data.Profile.length > 0) {\n      const profile = data.Profile[0];\n      const twitterHandle = profile[\"Twitter Handles\"];\n\n      result.basics.name = `${profile[\"First Name\"]} ${profile[\"Last Name\"]}`;\n      result.basics.location = profile[\"Geo Location\"];\n      result.basics.headline = profile.Headline;\n      // profile.Websites is represented as an array-like structure f.e. [COMPANY:https://some.link,PORTFOLIO:...]\n      const extractFirstWebsiteLink = (entry: string) =>\n        (parseArrayLikeCSVEntry(entry)[0] ?? \"\").replace(/.*?:/, \"\");\n      result.basics.url.href = extractUrl(extractFirstWebsiteLink(profile.Websites)) ?? \"\";\n      result.sections.summary.content = profile.Summary;\n      if (twitterHandle) {\n        result.sections.profiles.items.push({\n          ...defaultProfile,\n          id: createId(),\n          icon: \"twitter\",\n          network: \"Twitter\",\n          username: twitterHandle,\n          url: { ...defaultProfile.url, href: `https://twitter.com/${twitterHandle}` },\n        });\n      }\n    }\n\n    // Email Addresses\n    if (data[\"Email Addresses\"] && data[\"Email Addresses\"].length > 0) {\n      const email = data[\"Email Addresses\"][0];\n\n      result.basics.email = email[\"Email Address\"];\n    }\n\n    // Positions\n    if (data[\"Positions\"] && data[\"Positions\"].length > 0) {\n      for (const position of data[\"Positions\"]) {\n        result.sections.experience.items.push({\n          ...defaultExperience,\n          id: createId(),\n          company: position[\"Company Name\"],\n          position: position.Title,\n          location: position.Location,\n          summary: position.Description ?? \"\",\n          date: `${position[\"Started On\"]} - ${position[\"Finished On\"] ?? \"Present\"}`,\n        });\n      }\n    }\n\n    // Education\n    if (data[\"Education\"] && data[\"Education\"].length > 0) {\n      for (const education of data[\"Education\"]) {\n        result.sections.education.items.push({\n          ...defaultEducation,\n          id: createId(),\n          institution: avoidTooShort(education[\"School Name\"], 2),\n          studyType: avoidTooShort(education[\"Degree Name\"], 2),\n          summary: avoidTooShort(education.Notes ?? \"\", 2),\n          date: `${education[\"Start Date\"]} - ${education[\"End Date\"] ?? \"Present\"}`,\n        });\n      }\n    }\n\n    // Skills\n    if (data[\"Skills\"] && data[\"Skills\"].length > 0) {\n      for (const skill of data[\"Skills\"]) {\n        result.sections.skills.items.push({\n          ...defaultSkill,\n          id: createId(),\n          name: skill.Name,\n        });\n      }\n    }\n\n    // Languages\n    if (data[\"Languages\"] && data[\"Languages\"].length > 0) {\n      for (const language of data[\"Languages\"]) {\n        result.sections.languages.items.push({\n          ...defaultLanguage,\n          id: createId(),\n          name: language.Name,\n          description: language.Proficiency ?? \"\",\n        });\n      }\n    }\n\n    // Certifications\n    if (data[\"Certifications\"] && data[\"Certifications\"].length > 0) {\n      for (const certification of data[\"Certifications\"]) {\n        result.sections.certifications.items.push({\n          ...defaultCertification,\n          id: createId(),\n          name: certification.Name,\n          issuer: certification.Authority,\n          url: { ...defaultCertification.url, href: certification.Url },\n          date: `${certification[\"Started On\"]} - ${certification[\"Finished On\"] ?? \"Present\"}`,\n        });\n      }\n    }\n\n    // Projects\n    if (data[\"Projects\"] && data[\"Projects\"].length > 0) {\n      for (const project of data[\"Projects\"]) {\n        result.sections.projects.items.push({\n          ...defaultProject,\n          id: createId(),\n          name: project.Title,\n          description: project.Description,\n          url: { ...defaultProject.url, href: project.Url ?? \"\" },\n          date: `${project[\"Started On\"]} - ${project[\"Finished On\"] ?? \"Present\"}`,\n        });\n      }\n    }\n\n    return resumeDataSchema.parse(result);\n  }\n}\n"],"names":["LinkedInParser","readFile","file","data","JSZip","loadAsync","Object","keys","files","length","Error","validate","result","name","entries","key","linkedInSchema","shape","includes","content","async","jsonArray","parseCSV","parse","convert","JSON","stringify","defaultResumeData","avoidTooShort","len","Profile","profile","twitterHandle","basics","location","headline","Headline","extractFirstWebsiteLink","entry","parseArrayLikeCSVEntry","replace","extractUrl","url","href","Websites","sections","summary","Summary","profiles","items","push","defaultProfile","id","createId","icon","network","username","email","position","experience","defaultExperience","company","Title","Location","Description","date","education","defaultEducation","institution","studyType","Notes","skill","skills","defaultSkill","Name","language","languages","defaultLanguage","description","Proficiency","certification","certifications","defaultCertification","issuer","Authority","Url","project","projects","defaultProject","resumeDataSchema","constructor","schema"],"mappings":"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"}